<!DOCTYPE html>
<html lang="zh_CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RuetaleÂ·æµå¹´æœåŠ¡å™¨</title>
</head>
<style>
html{
    display: flex;
    justify-content: center;
    margin: 0;
    background-color: #DEF6D3;
}
body{
    margin: 0;
    margin-top: 50px;
    margin-bottom: 0;
    min-width: 320px;
    background-color: #FBFDF3;
    border-radius: 35px;
}
a{
    text-decoration-line: none;
}
h2{
    margin-top: -30px;font-size: 38px;color: #3F6836;
    
}
.tittle{
    width: 200px;
    height: 60px;
    font-size: 24px;
    line-height: 60px;
    margin-left: 40px;
}
    
    .download{
    margin-left: auto;
    display: flex;
    margin: auto 10px auto auto;
    background-color: #e0f8f07c;
    flex-direction: column;
    text-align: center;
    padding: 8px;
    border-radius: 16px;
}
.download a{
    background-color: rgb(228, 240, 236);
    color: rgb(109, 138, 128);
    margin: 2px auto;
    height: 26px;
    width: 125px;
    line-height: 26px;
    border-radius: 5px;
    font-size: 14px;
}
.downloadmain{
    height: 28px;
    width: 100px;
    text-align: center;
    line-height: 28px;
    font-size: 13px;
    border-radius: 5px;
    background-color: rgb(156,39,176);
    margin: auto 15px;
    color: white;
}
    .bedownload{
        background-color: #DEF6D3;
        margin: 0;
        padding: 6px;
        padding-left: 35px;
        border-radius: 0 30px 30px 0;
        width: 250px;
    }
    .bedownload a{
        color: #3f6836ea;
    }
    
    .advice{
        padding: 6px;
        padding-left: 35px;
        a{
            color: #3f6836ea;
            margin-right: 3px;
        }
    }
    .line{
        width: auto;
        height: 12px;
        background-color: #3f683693;
        margin: 0;
        padding: 0;
        width: 48px;
        margin-top: -27px;
    }
    .about{
    background-color: #EFF2E8;
    height: auto;
    margin: 0px 10px 0px 10%;
    border-radius: 35px 35px 35px 35px;
    padding: 40px;
    }
    .about p{
    margin: auto;
    }
    .state{
        padding: 0;
    }
    
</style>
<body>
    <div style="width: 100%;
    height: 50px;
    display: flex;
    justify-content: center;"><h2>RuetaleÂ·æµå¹´</h2></div>
    <div class="bedownload">
        åŸºå²©ç‰ˆä¸‹è½½:<br />
        <a href="https://mcapks.net/info/MS4yMS42MC4xMA%3D%3D/d6e2606b50d81934ad8606932b63fcc5.html">
            å®‰å“ç‰ˆ
        </a>
        <a href="https://cloud.nyan.run/s/DB9Cp" class="ios">
            iOSç‰ˆ
        </a>
        <a href="https://dl.mcappx.com/be-1-21-6010-x64-cn" class="windows">
            Windowsç‰ˆ
        </a>
        
        
        
        <a href="https://bbk.endyun.ltd/download" class="all">
            å…¨éƒ¨
        </a>
    </div>



    <div class="tittle" >
        <span>
            åŠ å…¥ï¼š
            <p class="line"></p>
        </span>
    </div>
    <script>
        function initMinecraftServerChecker(config = {}) {
    // é»˜è®¤é…ç½®
    const defaultConfig = {
        containerId: 'minecraft-server-checker',
        defaultServers: [{ address: "z1.ruetalex.cc:30021" }],
        displaySettings: {
            motd: true,
            version: true,
            players: true,
            gamemode: false,
            edition: false,
            software: false,
            plugins: false,
            delay: true
        },
        
        
        allowUserInput: false,
        refreshInterval: 10000,
        smoothingSamples: 10,
        apiProviders: [
            {
                name: 'MCSrvStat',
                url: (host, port) => `https://api.mcsrvstat.us/2/${host}:${port}`,
                parser: (data) => ({
                    latency: data.debug?.ping,
                    online: data.online,
                    players: data.players?.online
                })
            },
            {
                name: 'MCAPI',
                url: (host, port) => `https://mcapi.xdefcon.com/server/${host}/status`,
                parser: (data) => ({
                    latency: data.ping,
                    online: data.serverStatus === 'online',
                    players: data.players
                })
            },
            {
                name: 'MCStatus',
                url: (host, port) => `https://api.mcstatus.io/v2/status/bedrock/${host}:${port}`,
                parser: (data) => ({
                    latency: data.roundTripLatency,
                    online: data.online,
                    players: data.players.online
                })
            }
        ],
        theme: {
            cardBackgroundColor: '#2D2D2D',
            textColor: '#F0F0F0',
            secondaryTextColor: '#A0A0A0',
            accentColor: '#00A3E8',
            successColor: '#55FF55',
            warningColor: '#FFAA00',
            errorColor: '#FF5555',
            borderColor: '#3D3D3D',
            primaryColor: '#2196F3',
            successButtonColor: '#4CAF50',
            warningButtonColor: '#FFC107',
            dangerButtonColor: '#F44336'
        }
    };
console.log(defaultConfig.defaultServers[0].address);
    // åˆå¹¶ç”¨æˆ·é…ç½®å’Œé»˜è®¤é…ç½®
    const finalConfig = { ...defaultConfig, ...config };
    const {
        containerId,
        defaultServers,
        displaySettings,
        allowUserInput,
        refreshInterval,
        smoothingSamples,
        apiProviders,
        theme
    } = finalConfig;

    // åˆ›å»ºHTMLå†…å®¹
    const htmlContent = `
        <div id="${containerId}" class="minecraft-server-checker container">
            ${allowUserInput ? `
            <div class="controls" id="server-form-container">
                <form id="server-form">
                    <input type="text" id="server-address" placeholder="è¯·è¾“å…¥æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼ˆå¦‚ï¼šmc.example.com:19132ï¼‰" required>
                    <button type="submit">æ·»åŠ æœåŠ¡å™¨</button>
                </form>
            </div>
            ` : ''}
            <div class="server-list" id="server-list">
                <!-- æœåŠ¡å™¨å¡ç‰‡å°†åŠ¨æ€æ·»åŠ åœ¨è¿™é‡Œ -->
            </div>
        </div>
    `;

    // æŸ¥æ‰¾å®¹å™¨å¹¶æ’å…¥HTML
    const container = document.getElementById(containerId) || document.querySelector(`#${containerId}`);
    if (!container) {
        console.error(`æœªæ‰¾åˆ°å®¹å™¨å…ƒç´  #${containerId}`);
        return;
    }
    container.innerHTML = htmlContent;

    // è®¾ç½®æ ·å¼
    const style = document.createElement('style');
    style.textContent = `
        @font-face {
            font-family: 'Minecraft_English';
            src: url('./font/Minecraft_English.otf');
            font-weight: normal;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Minecraft_Chinese';
            src: url('./font/Minecraft_Chinese.ttf');
            font-weight: normal;
            font-style: normal;
        }
        
        .minecraft-server-checker {
            font-family: 'Minecraft_English', 'Minecraft_Chinese', monospace;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: ${theme.textColor};
        }

        .minecraft-server-checker .server-card {
            background-color: ${theme.cardBackgroundColor};
            border-radius: 8px;
            border: 1px solid ${theme.borderColor};
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            transition: transform 0.2s ease;
        }

        .minecraft-server-checker .server-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .minecraft-server-checker .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid ${theme.borderColor};
        }

        .minecraft-server-checker .server-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: ${theme.textColor};
        }

        .minecraft-server-checker .server-status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            height: 24px;
            width: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .minecraft-server-checker .status-online {
            background-color: ${theme.successColor};
            color: #000;
        }

        .minecraft-server-checker .status-offline {
            background-color: ${theme.errorColor};
            color: #000;
        }

        .minecraft-server-checker .server-address {
            font-size: 0.9rem;
            color: ${theme.secondaryTextColor};
            margin-bottom: 15px;
        }

        .minecraft-server-checker .server-motd {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            white-space: pre-line;
        }

        .minecraft-server-checker .server-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .minecraft-server-checker .info-item {
            display: flex;
            flex-direction: column;
        }

        .minecraft-server-checker .info-label {
            font-size: 0.8rem;
            color: ${theme.secondaryTextColor};
            margin-bottom: 5px;
        }

        .minecraft-server-checker .info-value {
            font-size: 1rem;
        }

        .minecraft-server-checker .info-value.green {
            color: ${theme.successColor};
        }

        .minecraft-server-checker .info-value.orange {
            color: ${theme.warningColor};
        }

        .minecraft-server-checker .info-value.red {
            color: ${theme.errorColor};
        }

        .minecraft-server-checker .info-value.blue {
            color: ${theme.accentColor};
        }

        .minecraft-server-checker .server-delay {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .minecraft-server-checker .last-updated {
            font-size: 0.8rem;
            color: ${theme.secondaryTextColor};
            text-align: right;
            margin-top: 10px;
        }

        .minecraft-server-checker .hidden {
            display: none;
        }

        .minecraft-server-checker .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: ${theme.accentColor};
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .minecraft-server-checker .server-form {
            display: flex;
            margin-bottom: 20px;
        }

        .minecraft-server-checker .server-form input {
            flex: 1;
            padding: 10px;
            border: 1px solid ${theme.borderColor};
            background-color: rgba(255, 255, 255, 0.1);
            color: ${theme.textColor};
            border-radius: 4px 0 0 4px;
            font-family: 'Minecraft', 'Minecraftia', monospace;
        }

        .minecraft-server-checker .server-form button {
            padding: 10px 15px;
            background-color: ${theme.accentColor};
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            font-family: 'Minecraft', 'Minecraftia', monospace;
        }

        .minecraft-server-checker .server-form button:hover {
            background-color: #0086C3;
        }
    `;
    document.head.appendChild(style);

    // DOMå…ƒç´ å¼•ç”¨
    const serverList = document.getElementById('server-list');
    const serverFormContainer = document.getElementById('server-form-container');
    const serverForm = document.getElementById('server-form');
    const serverAddressInput = document.getElementById('server-address');

    // æœåŠ¡å™¨åˆ—è¡¨
    let servers = defaultServers;
    // å­˜å‚¨å»¶è¿Ÿæ ·æœ¬
    const latencySamples = {};
    // æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡åŠ è½½
    let isFirstLoad = true;

    // åˆå§‹åŒ–é¡µé¢
    function init() {
        // åˆå§‹åŒ–å…è®¸ç”¨æˆ·è¾“å…¥çš„å¼€å…³
        if (!allowUserInput && serverFormContainer) {
            serverFormContainer.classList.add('hidden');
        }

        // åˆå§‹åŒ–é»˜è®¤æœåŠ¡å™¨
        renderServers();

        // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        if (serverForm) {
            serverForm.addEventListener('submit', handleAddServer);
        }

        // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
        setInterval(refreshServers, refreshInterval);
    }

    // å¤„ç†æ·»åŠ æœåŠ¡å™¨
    function handleAddServer(e) {
        e.preventDefault();

        const address = serverAddressInput.value.trim();
        if (address) {
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¯¥æœåŠ¡å™¨
            if (!servers.some(server => server.address === address)) {
                servers.push({ address });
                renderServers();
                serverAddressInput.value = '';
            } else {
                alert('è¯¥æœåŠ¡å™¨å·²å­˜åœ¨ï¼');
            }
        }
    }

    // æ¸²æŸ“æ‰€æœ‰æœåŠ¡å™¨
    function renderServers() {
        serverList.innerHTML = '';

        servers.forEach((server, index) => {
            const card = createServerCard(server, index);
            serverList.appendChild(card);
        });
    }

    // åˆ›å»ºæœåŠ¡å™¨å¡ç‰‡
    function createServerCard(server, index) {
        const card = document.createElement('div');
        card.className = 'server-card';
        card.dataset.index = index;

        // åŠ è½½åŠ¨ç”»ï¼ˆä»…åœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶æ˜¾ç¤ºï¼‰
        if (isFirstLoad) {
            card.innerHTML = `
                <div class="server-header">
                    <span class="server-name">åŠ è½½ä¸­...</span>
                    <span class="server-status">${loadingIcon()}</span>
                </div>
                <div class="server-address">æ­£åœ¨è·å–æœåŠ¡å™¨ä¿¡æ¯...è‹¥è·å–è¿‡ä¹…å»ºè®®åˆ·æ–°é¡µé¢</div>
                <div class="last-updated">çŠ¶æ€: æ­£åœ¨è·å–...</div>
            `;
        }

        // æ£€æŸ¥å¹¶æ›´æ–°æœåŠ¡å™¨çŠ¶æ€
        checkServerStatus(server.address)
            .then(status => {
                updateServerCard(card, server, status);
            })
            .catch(error => {
                console.error(`æ— æ³•è·å–æœåŠ¡å™¨ ${server.address} çš„çŠ¶æ€`, error);
                updateServerCard(card, server, {
                    online: false,
                    error: error.message || "æœªçŸ¥é”™è¯¯"
                });
            });

        return card;
    }

    // æ›´æ–°æœåŠ¡å™¨å¡ç‰‡
    function updateServerCard(card, server, status) {
        const index = card.dataset.index;
        const oldStatusElem = card.querySelector('.server-status');

        card.innerHTML = '';

        // è·å–å½“å‰æ—¶é—´
        const now = new Date();
        const formattedTime = now.toLocaleString();

        // åˆ›å»ºæœåŠ¡å™¨å¤´éƒ¨
        const header = document.createElement('div');
        header.className = 'server-header';

        const nameSpan = document.createElement('span');
        nameSpan.className = 'server-name';
        nameSpan.textContent = server.address.split(':')[0];
        header.appendChild(nameSpan);

        const statusSpan = document.createElement('a');
        statusSpan.href = `minecraft://?addExternalServer=RuetaleÂ·æµå¹´|${server.address}`
        statusSpan.className = `server-status ${status.online ? 'status-online' : 'status-offline'}`;
        statusSpan.textContent = status.online ? 'ä¸€é”®æ·»åŠ ' : 'ç¦»çº¿';
        header.appendChild(statusSpan);
        card.appendChild(header);

        // å¦‚æœæœåŠ¡å™¨åœ¨çº¿ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
        if (status.online) {
            // å¦‚æœæœ‰å…¬å‘Šï¼Œæ˜¾ç¤ºå…¬å‘Š
            if (displaySettings.motd && status.motd && status.motd.raw) {
                const motdDiv = document.createElement('div');
                motdDiv.className = 'server-delay';
                motdDiv.innerHTML = `
                <div class="info-label">IPåœ°å€</div>
                <div class="info-value">
                    ${server.address.split(':')[0]}
                </div>
            `;
                card.appendChild(motdDiv);
            }

            if (displaySettings.motd && status.motd && status.motd.raw) {
                const motdDiv = document.createElement('div');
                motdDiv.className = 'server-delay';
                motdDiv.innerHTML = `
                <div class="info-label">ç«¯å£</div>
                <div class="info-value">
                    ${server.address.split(':')[1]}
                </div>
            `;
                card.appendChild(motdDiv);
            }

            // APIå»¶è¿Ÿä¿¡æ¯
            const apiDelayDiv = document.createElement('div');
            apiDelayDiv.className = 'server-delay';
            apiDelayDiv.innerHTML = `
                <div class="info-label">å»¶è¿Ÿ</div>
                <div class="info-value">
                    ${status.apiLatency !== undefined ? 
                        `${status.apiLatency}ms` : 
                        'æœªæ£€æµ‹åˆ°APIå»¶è¿Ÿ'
                    }
                </div>
            `;
            card.appendChild(apiDelayDiv);

            // åˆ›å»ºæœåŠ¡å™¨ä¿¡æ¯éƒ¨åˆ†
            const infoDiv = document.createElement('div');
            infoDiv.className = 'server-info';

            // ç‰ˆæœ¬ä¿¡æ¯
            if (displaySettings.version && status.version) {
                const versionItem = document.createElement('div');
                versionItem.className = 'info-item';
                if (status.edition === "MCPE") {
                    versionItem.innerHTML = `
                    <div class="info-label">ç‰ˆæœ¬</div>
                    <div class="info-value blue">åŸºå²©ç‰ˆ${status.version.name}</div>
                `;
                } else {versionItem.innerHTML = `
                    <div class="info-label">ç‰ˆæœ¬</div>
                    <div class="info-value blue">JAVAç‰ˆ${status.version.name}</div>
                `;}
                infoDiv.appendChild(versionItem);
            }


            // ç©å®¶ä¿¡æ¯
            if (displaySettings.players && status.players) {
                const playersItem = document.createElement('div');
                playersItem.className = 'info-item';
                playersItem.innerHTML = `
                    <div class="info-label">åœ¨çº¿</div>
                    <div class="info-value green">${status.players.online}/${status.players.max}</div>
                `;
                infoDiv.appendChild(playersItem);
            }

            // æ¸¸æˆæ¨¡å¼
            if (displaySettings.gamemode && status.gamemode) {
                const gamemodeItem = document.createElement('div');
                gamemodeItem.className = 'info-item';
                gamemodeItem.innerHTML = `
                    <div class="info-label">æ¸¸æˆæ¨¡å¼</div>
                    <div class="info-value">${status.gamemode}</div>
                `;
                infoDiv.appendChild(gamemodeItem);
            }

            // ç‰ˆæœ¬ä¿¡æ¯
            if (displaySettings.edition && status.edition) {
                const editionItem = document.createElement('div');
                editionItem.className = 'info-item';
                if (status.edition === "MCPE") {
                    editionItem.innerHTML = `
                    <div class="info-label">ç‰ˆæœ¬</div>
                    <div class="info-value">åŸºå²©ç‰ˆ</div>
                `;
                } else {editionItem.innerHTML = `
                    <div class="info-label">ç‰ˆæœ¬</div>
                    <div class="info-value">JAVAç‰ˆ</div>
                `;}
                
                infoDiv.appendChild(editionItem);
            }

            // è½¯ä»¶ä¿¡æ¯
            if (displaySettings.software && status.software) {
                const softwareItem = document.createElement('div');
                softwareItem.className = 'info-item';
                softwareItem.innerHTML = `
                    <div class="info-label">è½¯ä»¶</div>
                    <div class="info-value">${status.software}</div>
                `;
                infoDiv.appendChild(softwareItem);
            }

            // æ’ä»¶ä¿¡æ¯
            if (displaySettings.plugins && status.plugins && status.plugins.length > 0) {
                const pluginsItem = document.createElement('div');
                pluginsItem.className = 'info-item';
                pluginsItem.innerHTML = `
                    <div class="info-label">æ’ä»¶</div>
                    <div class="info-value">${status.plugins.join(', ')}</div>
                `;
                infoDiv.appendChild(pluginsItem);
            }
            //qqç¾¤
            const qqGroup = document.createElement('div');
                qqGroup.className = 'info-item';
                qqGroup.innerHTML = `
                    <div class="info-label">ç¾¤èŠ</div>
                    <a href = "https://qm.qq.com/q/rTuZaEF2s" class="info-value green">706118248</a>
                `;
                infoDiv.appendChild(qqGroup);

            
            //ä¸€é”®æ·»åŠ 
            const addServer = document.createElement('div');
                addServer.className = 'info-item';
                addServer.innerHTML = `
                    <div class="info-label">åŠ å…¥</div>
                    <a href = "minecraft://?addExternalServer=RuetaleÂ·æµå¹´|${server.address}" class="info-value green">ä¸€é”®æ·»åŠ </a>
                `;
                infoDiv.appendChild(addServer);

            // å¦‚æœæœ‰ä¿¡æ¯æ·»åŠ ï¼Œåˆ™æ·»åŠ ä¿¡æ¯å®¹å™¨
            if (infoDiv.children.length > 0) {
                card.appendChild(infoDiv);
            }

            // æ›´æ–°æ—¶é—´
            const updatedDiv = document.createElement('div');
            updatedDiv.className = 'last-updated';
            updatedDiv.textContent = `çŠ¶æ€: ${formattedTime}`;
            card.appendChild(updatedDiv);
            nameSpan.innerHTML = parseMinecraftColors(status.motd.raw);
        } else {
            // æœåŠ¡å™¨ç¦»çº¿çŠ¶æ€
            if (defaultConfig.defaultServers[0].address === "z1.ruetalex.cc:30021") {
                defaultConfig.defaultServers[0].address = "z1.rainyland.cc:30021"
            } else {
                defaultConfig.defaultServers[0].address = "z1.ruetalex.cc:30021"
            }
            
            refreshServers();
            const errorDiv = document.createElement('div');
            errorDiv.className = 'server-delay';
            errorDiv.innerHTML = `
                <div class="info-label">é”™è¯¯</div>
                <div class="info-value red">${status.error || 'æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¨ååˆ·æ–°'}</div>
            `;
            card.appendChild(errorDiv);

            // æ›´æ–°æ—¶é—´
            const updatedDiv = document.createElement('div');
            updatedDiv.className = 'last-updated';
            updatedDiv.textContent = `çŠ¶æ€: ${formattedTime}`;
            card.appendChild(updatedDiv);
        }
    }

    // æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€å¹¶è·å–å»¶è¿Ÿ
    async function checkServerStatus(address) {
        const [hostname, port] = address.split(':');

        try {
            // ä»MCStatus APIè·å–åŸºç¡€çŠ¶æ€ä¿¡æ¯
            const mcStatusResponse = await fetch(`https://api.mcstatus.io/v2/status/bedrock/${hostname}:${port}`);
            if (!mcStatusResponse.ok) {
                throw new Error(`MCStatus APIè¿”å›é”™è¯¯: ${mcStatusResponse.status}`);
            }

            const mcStatusData = await mcStatusResponse.json();

            // å¹¶è¡Œè¯·æ±‚å…¶ä»–APIä»¥è·å–å»¶è¿Ÿä¿¡æ¯
            const results = await Promise.allSettled(
                apiProviders.map(provider => 
                    fetchAPI(provider.url(hostname, port || 19132), provider.parser)
                )
            );

            // æŸ¥æ‰¾æœ€å¯é çš„å»¶è¿Ÿç»“æœ
            let bestLatency = null;
            let bestApiSource = null;
            let bestApiLatency = null;

            for (const result of results) {
                if (result.status === 'fulfilled' && result.value.success) {
                    if (bestLatency === null || result.value.latency < bestLatency) {
                        bestLatency = result.value.latency;
                        bestApiSource = result.value.source;
                        bestApiLatency = result.value.apiLatency;
                    }
                }
            }

            return {
                online: mcStatusData.online,
                error: mcStatusData.error_message,
                ...mcStatusData,
                latency: bestLatency,
                apiSource: bestApiSource,
                apiLatency: bestApiLatency
            };
        } catch (error) {
            console.error(`æ— æ³•è·å–æœåŠ¡å™¨ ${address} çš„çŠ¶æ€`, error);
            return {
                online: false,
                error: error.message || "æ— æ³•è¿æ¥åˆ°API"
            };
        }
    }

    // è·å–APIå»¶è¿Ÿæ•°æ®
    async function fetchAPI(url, parser) {
        try {
            const startTime = Date.now();
            const response = await fetch(url);

            if (!response.ok) throw new Error('APIè¯·æ±‚å¤±è´¥');

            const data = await response.json();
            const apiLatency = Date.now() - startTime;

            return {
                success: true,
                ...parser(data),
                apiLatency,
                source: url.split('/')[2]
            };
        } catch (error) {
            return {
                success: false,
                error: error.message,
                source: url.split('/')[2]
            };
        }
    }

    // è§£æMinecrafté¢œè‰²ä»£ç 
    function parseMinecraftColors(text) {
        // Minecrafté¢œè‰²ä»£ç æ˜ å°„
        const colorMap = {
            '0': '#000000', // é»‘è‰²
            '1': '#0000AA', // æ·±è“è‰²
            '2': '#00AA00', // æ·±ç»¿è‰²
            '3': '#00AAAA', // æ·±é’è‰²
            '4': '#AA0000', // æ·±çº¢è‰²
            '5': '#AA00AA', // æ·±ç´«è‰²
            '6': '#FFAA00', // é‡‘è‰²
            '7': '#AAAAAA', // ç°è‰²
            '8': '#555555', // æ·±ç°è‰²
            '9': '#5555FF', // è“è‰²
            'a': '#55FF55', // ç»¿è‰²
            'b': '#55FFFF', // é’è‰²
            'c': '#FF5555', // çº¢è‰²
            'd': '#FF55FF', // ç²‰çº¢è‰²
            'e': '#FFFF55', // é»„è‰²
            'f': '#FFFFFF', // ç™½è‰²
            'k': 'obfuscated', // éšè—
            'l': 'bold', // åŠ ç²—
            'm': 'strikethrough', // åˆ é™¤çº¿
            'n': 'underline', // ä¸‹åˆ’çº¿
            'o': 'italic', // æ–œä½“
            'r': 'reset' // é‡ç½®
        };

        let result = '';
        let currentStyle = {};

        // åˆ†å‰²æ–‡æœ¬ä¸ºæ®µè½
        const paragraphs = text.split('\n');

        paragraphs.forEach(paragraph => {
            let paragraphHtml = '';
            let currentColor = null;
            let currentStyles = [];

            // åˆ†å‰²æ–‡æœ¬ä¸ºé¢œè‰²ä»£ç å’Œæ–‡æœ¬éƒ¨åˆ†
            let i = 0;
            while (i < paragraph.length) {
                if (paragraph[i] === 'Â§' && i + 1 < paragraph.length) {
                    const code = paragraph[i + 1].toLowerCase();
                    if (colorMap[code]) {
                        // å¤„ç†é¢œè‰²ä»£ç 
                        if (code === 'r') {
                            // é‡ç½®æ ·å¼
                            currentColor = null;
                            currentStyles = [];
                        } else if (colorMap[code].startsWith('#')) {
                            // é¢œè‰²ä»£ç 
                            currentColor = colorMap[code];
                        } else {
                            // æ ·å¼ä»£ç 
                            if (!currentStyles.includes(colorMap[code])) {
                                currentStyles.push(colorMap[code]);
                            }
                        }

                        i += 2;
                        continue;
                    }
                }

                // å¤„ç†æ™®é€šå­—ç¬¦
                let char = paragraph[i];
                let spanHtml = '';

                if (currentColor || currentStyles.length > 0) {
                    spanHtml = `<span style="`;

                    if (currentColor) {
                        spanHtml += `color: ${currentColor}; `;
                    }

                    if (currentStyles.includes('bold')) {
                        spanHtml += 'font-weight: bold; ';
                    }

                    if (currentStyles.includes('italic')) {
                        spanHtml += 'font-style: italic; ';
                    }

                    if (currentStyles.includes('underline')) {
                        spanHtml += 'text-decoration: underline; ';
                    }

                    if (currentStyles.includes('strikethrough')) {
                        spanHtml += 'text-decoration: line-through; ';
                    }

                    if (currentStyles.includes('obfuscated')) {
                        // éšè—æ–‡æœ¬
                        const hiddenChar = String.fromCharCode(Math.floor(Math.random() * 95) + 32);
                        spanHtml += '">';
                        char = hiddenChar;
                    } else {
                        spanHtml += '">';
                    }

                    spanHtml += char + '</span>';
                } else {
                    spanHtml = char;
                }

                paragraphHtml += spanHtml;
                i++;
            }

            // æ·»åŠ æ®µè½ç»“å°¾
            result += `<div>${paragraphHtml}</div>`;
        });

        return result;
    }

    // åŠ è½½åŠ¨ç”»
    function loadingIcon() {
        return `
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" fill="${theme.accentColor}" fill-opacity="0.3">
                    <animate attributeName="fill-opacity" values="0.3;0.6;0.3" dur="1s" repeatCount="indefinite" />
                </circle>
                <circle cx="12" cy="12" r="5" fill="${theme.accentColor}" fill-opacity="0.6">
                    <animate attributeName="r" values="5;8;5" dur="1s" repeatCount="indefinite" />
                </circle>
            </svg>
        `;
    }

    // è·å–å¹³å‡å»¶è¿Ÿ
    function getAverageLatency(status) {
        if (status.latency !== undefined) {
            return status.latency;
        }
        return "æµ‹é‡ä¸­...";
    }

    // åˆ·æ–°æ‰€æœ‰æœåŠ¡å™¨çŠ¶æ€
    async function refreshServers() {
        const serverCards = document.querySelectorAll('.server-card');

        serverCards.forEach((card, index) => {
            if (index >= servers.length) return;

            const server = servers[index];

            // æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€å¹¶æ›´æ–°å¡ç‰‡
            checkServerStatus(server.address)
                .then(status => {
                    updateServerCard(card, server, status);
                })
                .catch(error => {
                    console.error(`æ— æ³•åˆ·æ–°æœåŠ¡å™¨ ${server.address} çš„çŠ¶æ€`, error);
                    updateServerCard(card, server, {
                        online: false,
                        error: error.message || "åˆ·æ–°å¤±è´¥"
                    });
                });
        });

        // ç¬¬ä¸€æ¬¡åŠ è½½å®Œæˆåéšè—åŠ è½½åŠ¨ç”»
        if (isFirstLoad) {
            isFirstLoad = false;
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    if (document.readyState !== 'loading') {
        init();
    } else {
        document.addEventListener('DOMContentLoaded', init);
    }
}
    </script>
<div id="minecraft-server-checker"></div>
    <script>
        initMinecraftServerChecker();
    </script>
            <div class="tittle">
                è¯´æ˜ï¼š
                <p class="line"></p>
            </div>
        <div class="about">
            <p>ğŸ‰ æ¬¢è¿åŠ å…¥ã€ŒRuetaleâ€¢æµå¹´ã€æœåŠ¡å™¨ï¼<br>
âš ï¸ æ¸¸ç©æœ¬æœåŠ¡å¿…éµå®ˆæœåŠ¡å™¨è§„åˆ™ï¼ˆç¾¤å…¬å‘Šï¼‰<br>
â€”â€”<br>
ğŸ¥” åœ°å€ä¸ç«¯å£<br>
åŸŸåï¼šz1.ruetalex.cc<br>
ç«¯å£ï¼š30021<br>
æ”¯æŒç‰ˆæœ¬ï¼š1.21.5x-1.21.8x<br>
å®‰å“å…±å­˜ç‰ˆ&ç”µè„‘ç‰ˆå®‰è£…åŒ…åœ¨ç¾¤æ–‡ä»¶<br>
â€”â€”<br>
ğŸ“– æ·»åŠ æ¸¸æˆè´¦å· (ç”¨äºæŸ¥è¯¢ç»Ÿè®¡å’Œé‡‘å¸)<br>
ç¾¤èŠå‘é€ï¼š<br>
ç»‘å®š ä½ çš„æ¸¸æˆåå­—<br>
ä¾‹ï¼šç»‘å®šxiaobai233<br>
âš ï¸ æ¸¸æˆåæ³¨æ„å¤§å°å†™ï¼<br>
å¦‚éœ€é‡æ–°ç»‘å®š, å‘é€"è§£ç»‘"å³å¯ã€‚</p>
            
        </div>
        <br>
            <div class="advice">
                æ¨è:<br />
                <a href="https://www.minebbs.com/resources/ui.11452/">èœå•UI</a>
                <a href="https://glyph-7zp.pages.dev/">ç‰¹æ®Šç¬¦å·</a>
            </div>
            <br>
            <script>
                
var ua = navigator.userAgent.toLowerCase();
if (ua.match(/QQ/i) == "qq") {
    if (ua.indexOf('qqtheme') > -1) {
        document.querySelector("body").innerHTML = "<h2>è¯·å¤åˆ¶é“¾æ¥åˆ°æµè§ˆå™¨æ‰“å¼€</h2><br><p>https://ruetale.pages.dev/</p>"
    } else {
        
    }
} else {
    
}




            </script>
</body>
</html>